<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Signum ‚Äî Website Trust Intelligence</title>
  <meta name="description" content="Instantly check if any website is safe. 20 intelligence sources, AI-powered risk analysis." />
  <meta property="og:title" content="Signum ‚Äî Website Trust Intelligence" />
  <meta property="og:description" content="Check any website for scams, fraud and safety risks. Free, instant, AI-powered." />
  <meta property="og:type" content="website" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg:       #0b0f1a;
      --bg2:      #111827;
      --surface:  #131c2e;
      --surface2: #1a2540;
      --border:   #1e2d4a;
      --border2:  #243358;
      --text:     #e8edf5;
      --text-muted: #7a8aaa;
      --text-faint: #3d4f6e;
      --blue:     #3b82f6;
      --blue-soft:#1d3461;
      --blue-glow:rgba(59,130,246,0.15);
      --green:    #22c55e;
      --green-bg: rgba(34,197,94,0.08);
      --green-border: rgba(34,197,94,0.25);
      --yellow:   #eab308;
      --yellow-bg: rgba(234,179,8,0.08);
      --yellow-border: rgba(234,179,8,0.25);
      --red:      #ef4444;
      --red-bg:   rgba(239,68,68,0.08);
      --red-border: rgba(239,68,68,0.25);
      --r: 10px;
    }
    body { background: var(--bg); font-family: 'DM Sans', sans-serif; color: var(--text); min-height: 100vh; font-size: 15px; line-height: 1.6; -webkit-font-smoothing: antialiased; }
    .page { max-width: 680px; margin: 0 auto; padding: 0 20px 100px; }

    /* ‚îÄ‚îÄ NAV ‚îÄ‚îÄ */
    nav { display: flex; align-items: center; justify-content: space-between; padding: 18px 0 16px; border-bottom: 1px solid var(--border); margin-bottom: 52px; }
    .logo { display: flex; align-items: center; gap: 9px; font-size: 17px; font-weight: 600; letter-spacing: -0.4px; color: var(--text); text-decoration: none; }
    .logo-icon { width: 28px; height: 28px; background: var(--blue); border-radius: 7px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 16px rgba(59,130,246,0.4); }
    .logo-icon svg { width: 15px; height: 15px; stroke: #fff; fill: none; stroke-width: 2.2; stroke-linecap: round; stroke-linejoin: round; }
    .nav-right { display: flex; align-items: center; gap: 8px; }
    .lang-toggle { display: flex; background: var(--surface2); border-radius: 6px; padding: 2px; border: 1px solid var(--border); }
    .lang-btn { background: none; border: none; padding: 4px 10px; font-family: 'DM Mono', monospace; font-size: 11px; font-weight: 500; cursor: pointer; border-radius: 4px; color: var(--text-muted); transition: all 0.15s; letter-spacing: 0.3px; }
    .lang-btn.active { background: var(--blue); color: #fff; }
    .btn-sm { padding: 7px 16px; border-radius: 7px; font-size: 13px; font-weight: 500; font-family: 'DM Sans', sans-serif; cursor: pointer; transition: all 0.15s; border: none; }
    .btn-outline { background: none; border: 1px solid var(--border2) !important; color: var(--text-muted); }
    .btn-outline:hover { border-color: var(--blue) !important; color: var(--blue); }
    .btn-blue { background: var(--blue); color: #fff; box-shadow: 0 0 20px rgba(59,130,246,0.3); }
    .btn-blue:hover { opacity: 0.88; }
    .nav-email { font-size: 12px; color: var(--text-muted); font-family: 'DM Mono', monospace; max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

    /* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
    .hero { margin-bottom: 40px; text-align: center; padding: 0 10px; }
    .hero-badge { display: inline-flex; align-items: center; gap: 8px; background: var(--surface); border: 1px solid var(--border2); border-radius: 100px; padding: 5px 14px; font-size: 12px; color: var(--text-muted); margin-bottom: 24px; font-family: 'DM Mono', monospace; }
    .badge-dot { width: 6px; height: 6px; background: var(--green); border-radius: 50%; animation: blink 2.5s ease-in-out infinite; flex-shrink: 0; box-shadow: 0 0 6px var(--green); }
    @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.3} }
    .hero-title { font-size: clamp(28px, 5vw, 42px); font-weight: 600; letter-spacing: -1.2px; line-height: 1.12; color: var(--text); margin-bottom: 14px; }
    .hero-title em { color: var(--blue); font-style: normal; }
    .hero-sub { font-size: 15px; color: var(--text-muted); max-width: 460px; margin: 0 auto; line-height: 1.65; }

    /* ‚îÄ‚îÄ BANNERS ‚îÄ‚îÄ */
    .plan-banner { display: none; align-items: center; justify-content: space-between; gap: 12px; border-radius: var(--r); padding: 11px 16px; margin-bottom: 16px; font-size: 13px; flex-wrap: wrap; }
    .plan-banner.free { background: var(--yellow-bg); border: 1px solid var(--yellow-border); }
    .plan-banner.pro  { background: var(--green-bg); border: 1px solid var(--green-border); }
    .banner-label { font-weight: 600; color: var(--text); font-size: 13px; }
    .banner-sub { font-size: 12px; color: var(--text-muted); }
    .btn-upgrade { background: var(--blue); color: #fff; border: none; padding: 7px 16px; border-radius: 7px; font-size: 13px; font-weight: 500; cursor: pointer; font-family: 'DM Sans', sans-serif; white-space: nowrap; transition: opacity 0.15s; }
    .btn-upgrade:hover { opacity: 0.85; }

    /* ‚îÄ‚îÄ SEARCH ‚îÄ‚îÄ */
    .search-wrap { margin-bottom: 40px; }
    .search-box { display: flex; gap: 8px; background: var(--surface); border: 1.5px solid var(--border2); border-radius: var(--r); padding: 7px 7px 7px 18px; box-shadow: 0 4px 24px rgba(0,0,0,0.3), 0 0 0 1px rgba(59,130,246,0); transition: all 0.2s; }
    .search-box:focus-within { border-color: var(--blue); box-shadow: 0 4px 24px rgba(0,0,0,0.3), 0 0 0 3px var(--blue-glow); }
    .search-input { flex: 1; background: none; border: none; outline: none; font-size: 15px; font-family: 'DM Sans', sans-serif; color: var(--text); min-width: 0; }
    .search-input::placeholder { color: var(--text-faint); }
    .search-btn { background: var(--blue); color: #fff; border: none; padding: 10px 24px; border-radius: 7px; font-size: 14px; font-weight: 500; font-family: 'DM Sans', sans-serif; cursor: pointer; white-space: nowrap; transition: opacity 0.15s; flex-shrink: 0; box-shadow: 0 0 20px rgba(59,130,246,0.35); }
    .search-btn:hover { opacity: 0.85; }
    .search-btn:disabled { opacity: 0.35; cursor: not-allowed; box-shadow: none; }
    .search-hint { margin-top: 9px; text-align: center; font-size: 12px; color: var(--text-faint); font-family: 'DM Mono', monospace; }

    /* ‚îÄ‚îÄ HOW IT WORKS ‚îÄ‚îÄ */
    .how-wrap { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 44px; }
    @media(max-width:520px){ .how-wrap { grid-template-columns: 1fr; } }
    .how-step { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r); padding: 18px; }
    .how-num { font-family: 'DM Mono', monospace; font-size: 11px; color: var(--blue); margin-bottom: 8px; font-weight: 500; }
    .how-title { font-size: 14px; font-weight: 600; margin-bottom: 4px; color: var(--text); }
    .how-sub { font-size: 12px; color: var(--text-muted); line-height: 1.5; }

    /* ‚îÄ‚îÄ STATUS ‚îÄ‚îÄ */
    .status-wrap { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r); padding: 16px 20px; margin-bottom: 16px; display: none; }
    .status-wrap.visible { display: block; }
    .status-inner { display: flex; align-items: center; gap: 12px; }
    .spinner { width: 15px; height: 15px; border: 2px solid var(--border2); border-top-color: var(--blue); border-radius: 50%; animation: spin 0.7s linear infinite; flex-shrink: 0; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .status-text { font-size: 13px; color: var(--text-muted); font-family: 'DM Mono', monospace; }

    /* ‚îÄ‚îÄ MESSAGES ‚îÄ‚îÄ */
    .msg { border-radius: var(--r); padding: 12px 16px; font-size: 13px; font-weight: 500; margin-bottom: 16px; display: none; }
    .msg.visible { display: block; }
    .msg.error   { background: var(--red-bg); border: 1px solid var(--red-border); color: var(--red); }
    .msg.success { background: var(--green-bg); border: 1px solid var(--green-border); color: var(--green); }

    /* ‚îÄ‚îÄ REPORT ‚îÄ‚îÄ */
    .report { display: none; }
    .report.visible { display: block; animation: fadeUp 0.3s ease; }
    @keyframes fadeUp { from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:none} }

    /* Verdict card */
    .verdict-card { border-radius: var(--r); padding: 24px; margin-bottom: 10px; }
    .verdict-card.GREEN { background: var(--green-bg); border: 1px solid var(--green-border); }
    .verdict-card.YELLOW { background: var(--yellow-bg); border: 1px solid var(--yellow-border); }
    .verdict-card.RED { background: var(--red-bg); border: 1px solid var(--red-border); }
    .verdict-top { display: flex; align-items: center; gap: 20px; margin-bottom: 20px; flex-wrap: wrap; }
    .score-ring { position: relative; width: 80px; height: 80px; flex-shrink: 0; }
    .score-ring svg { width: 80px; height: 80px; transform: rotate(-90deg); }
    .score-ring-bg { fill: none; stroke-width: 6; stroke: rgba(255,255,255,0.06); }
    .score-ring-fill { fill: none; stroke-width: 6; stroke-linecap: round; transition: stroke-dashoffset 1s ease; }
    .verdict-card.GREEN .score-ring-fill { stroke: var(--green); }
    .verdict-card.YELLOW .score-ring-fill { stroke: var(--yellow); }
    .verdict-card.RED .score-ring-fill { stroke: var(--red); }
    .score-center { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    .score-num { font-size: 22px; font-weight: 700; letter-spacing: -1px; line-height: 1; }
    .verdict-card.GREEN .score-num { color: var(--green); }
    .verdict-card.YELLOW .score-num { color: var(--yellow); }
    .verdict-card.RED .score-num { color: var(--red); }
    .score-lbl { font-size: 9px; font-family: 'DM Mono', monospace; color: var(--text-faint); margin-top: 2px; }
    .verdict-meta { flex: 1; min-width: 160px; }
    .verdict-label { font-size: 22px; font-weight: 700; letter-spacing: -0.5px; margin-bottom: 4px; }
    .verdict-card.GREEN .verdict-label { color: var(--green); }
    .verdict-card.YELLOW .verdict-label { color: var(--yellow); }
    .verdict-card.RED .verdict-label { color: var(--red); }
    .verdict-summary { font-size: 14px; color: var(--text-muted); line-height: 1.55; }

    /* Dashboard signals */
    .dashboard { background: rgba(0,0,0,0.2); border-radius: 8px; padding: 16px; border: 1px solid rgba(255,255,255,0.05); }
    .dashboard-row { display: flex; align-items: center; gap: 8px; padding: 5px 0; font-size: 13px; color: var(--text-muted); border-bottom: 1px solid rgba(255,255,255,0.04); }
    .dashboard-row:last-child { border-bottom: none; }
    .dash-icon { font-size: 13px; flex-shrink: 0; width: 20px; }
    .confidence-row { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
    .confidence-label { font-size: 12px; font-family: 'DM Mono', monospace; color: var(--text-faint); }
    .confidence-badge { font-size: 11px; font-family: 'DM Mono', monospace; font-weight: 500; padding: 2px 8px; border-radius: 100px; }
    .conf-high { background: rgba(34,197,94,0.15); color: var(--green); }
    .conf-med  { background: rgba(234,179,8,0.15); color: var(--yellow); }
    .conf-low  { background: rgba(239,68,68,0.15); color: var(--red); }

    /* Share btn */
    .share-btn { display: inline-flex; align-items: center; gap: 6px; margin-top: 14px; background: none; border: 1px solid var(--border2); border-radius: 7px; padding: 7px 14px; font-size: 12px; font-family: 'DM Sans', sans-serif; color: var(--text-muted); cursor: pointer; transition: all 0.15s; font-weight: 500; }
    .share-btn:hover { border-color: var(--blue); color: var(--blue); }

    /* Sections */
    .section { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r); padding: 20px; margin-bottom: 10px; }
    .section-header { font-size: 11px; font-family: 'DM Mono', monospace; font-weight: 500; color: var(--text-faint); letter-spacing: 0.8px; text-transform: uppercase; margin-bottom: 14px; }
    .finding { display: flex; gap: 12px; padding: 9px 0; border-bottom: 1px solid var(--border); }
    .finding:last-child { border-bottom: none; padding-bottom: 0; }
    .finding:first-child { padding-top: 0; }
    .f-icon { font-size: 15px; flex-shrink: 0; width: 22px; margin-top: 2px; }
    .f-body { flex: 1; }
    .f-tag { display: inline-block; font-size: 10px; font-family: 'DM Mono', monospace; font-weight: 500; padding: 2px 7px; border-radius: 4px; margin-bottom: 3px; }
    .f-tag.RISK    { background: var(--red-bg); color: var(--red); border: 1px solid var(--red-border); }
    .f-tag.CAUTION { background: var(--yellow-bg); color: var(--yellow); border: 1px solid var(--yellow-border); }
    .f-tag.OK      { background: var(--green-bg); color: var(--green); border: 1px solid var(--green-border); }
    .f-text { font-size: 13px; color: var(--text-muted); line-height: 1.5; }
    .narrative { font-size: 14px; color: var(--text-muted); line-height: 1.7; }
    .raw-btn { background: none; border: none; font-size: 12px; font-family: 'DM Mono', monospace; color: var(--text-faint); cursor: pointer; display: flex; align-items: center; gap: 6px; padding: 0; margin-bottom: 10px; }
    .raw-btn:hover { color: var(--text-muted); }
    .data-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 8px; max-height: 0; overflow: hidden; transition: max-height 0.35s; }
    .data-grid.open { max-height: 2000px; }
    .data-cell { background: var(--bg2); border: 1px solid var(--border); border-radius: 8px; padding: 10px 12px; }
    .data-lbl { font-size: 10px; font-family: 'DM Mono', monospace; color: var(--text-faint); margin-bottom: 3px; }
    .data-val { font-size: 12px; color: var(--text-muted); }

    /* ‚îÄ‚îÄ TRUST STRIP ‚îÄ‚îÄ */
    .trust-strip { display: flex; align-items: center; justify-content: center; gap: 24px; flex-wrap: wrap; margin: 44px 0; padding: 20px; background: var(--surface); border: 1px solid var(--border); border-radius: var(--r); }
    .trust-item { display: flex; align-items: center; gap: 8px; font-size: 12px; color: var(--text-muted); font-weight: 500; }
    .trust-icon { font-size: 15px; }

    /* ‚îÄ‚îÄ PRICING ‚îÄ‚îÄ */
    .pricing { margin-top: 56px; padding-top: 48px; border-top: 1px solid var(--border); }
    .pricing-head { text-align: center; margin-bottom: 28px; }
    .pricing-title { font-size: 26px; font-weight: 600; letter-spacing: -0.6px; margin-bottom: 6px; }
    .pricing-sub { font-size: 14px; color: var(--text-muted); }
    .pricing-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    @media(max-width:520px){ .pricing-grid { grid-template-columns: 1fr; } }
    .pricing-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--r); padding: 24px; position: relative; }
    .pricing-card.pro { border-color: var(--blue); box-shadow: 0 0 24px var(--blue-glow); }
    .popular-badge { position: absolute; top: -11px; left: 50%; transform: translateX(-50%); background: var(--blue); color: #fff; font-size: 10px; font-weight: 600; font-family: 'DM Mono', monospace; padding: 3px 12px; border-radius: 100px; white-space: nowrap; letter-spacing: 0.5px; }
    .plan-name { font-size: 11px; font-family: 'DM Mono', monospace; font-weight: 500; color: var(--text-faint); letter-spacing: 1px; text-transform: uppercase; margin-bottom: 10px; }
    .plan-price { font-size: 34px; font-weight: 700; letter-spacing: -1.5px; margin-bottom: 2px; }
    .plan-period { font-size: 12px; color: var(--text-muted); margin-bottom: 20px; }
    .plan-features { list-style: none; margin-bottom: 22px; }
    .plan-features li { font-size: 13px; color: var(--text-muted); padding: 7px 0; border-bottom: 1px solid var(--border); display: flex; align-items: flex-start; gap: 8px; }
    .plan-features li:last-child { border-bottom: none; }
    .plan-features li .fi { font-size: 12px; margin-top: 2px; flex-shrink: 0; color: var(--green); }
    .plan-features li.muted .fi { color: var(--text-faint); }
    .plan-features li.muted { color: var(--text-faint); }
    .plan-cta { width: 100%; padding: 11px; border-radius: 8px; font-size: 14px; font-weight: 500; font-family: 'DM Sans', sans-serif; cursor: pointer; transition: all 0.15s; }
    .plan-cta.outline { background: none; border: 1px solid var(--border2); color: var(--text-muted); }
    .plan-cta.outline:hover { border-color: var(--blue); color: var(--blue); }
    .plan-cta.filled { background: var(--blue); border: none; color: #fff; box-shadow: 0 0 20px var(--blue-glow); }
    .plan-cta.filled:hover { opacity: 0.85; }
    .pricing-note { text-align: center; margin-top: 14px; font-size: 12px; color: var(--text-faint); }

    /* ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ */
    .modal-bg { position: fixed; inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(8px); z-index: 200; display: none; align-items: center; justify-content: center; padding: 20px; }
    .modal-bg.open { display: flex; }
    .modal { background: var(--surface2); border: 1px solid var(--border2); border-radius: 16px; padding: 32px; width: 100%; max-width: 380px; box-shadow: 0 32px 80px rgba(0,0,0,0.5); position: relative; animation: mIn 0.2s ease; }
    @keyframes mIn { from{opacity:0;transform:scale(0.95)} to{opacity:1;transform:none} }
    .modal-x { position: absolute; top: 14px; right: 14px; background: none; border: none; color: var(--text-faint); font-size: 18px; cursor: pointer; width: 30px; height: 30px; border-radius: 6px; display: flex; align-items: center; justify-content: center; }
    .modal-x:hover { background: var(--surface); color: var(--text); }
    .modal-title { font-size: 20px; font-weight: 600; letter-spacing: -0.4px; margin-bottom: 4px; }
    .modal-sub { font-size: 13px; color: var(--text-muted); margin-bottom: 24px; }
    .modal-msg { font-size: 13px; padding: 10px 14px; border-radius: 8px; margin-bottom: 12px; display: none; font-weight: 500; }
    .modal-msg.visible { display: block; }
    .modal-msg.error   { background: var(--red-bg); color: var(--red); border: 1px solid var(--red-border); }
    .modal-msg.success { background: var(--green-bg); color: var(--green); border: 1px solid var(--green-border); }
    .modal-input { width: 100%; background: var(--bg2); border: 1.5px solid var(--border); color: var(--text); padding: 11px 14px; font-size: 14px; font-family: 'DM Sans', sans-serif; border-radius: 8px; outline: none; margin-bottom: 10px; display: block; transition: border-color 0.15s; }
    .modal-input:focus { border-color: var(--blue); }
    .modal-submit { width: 100%; background: var(--blue); border: none; color: #fff; padding: 12px; font-size: 14px; font-weight: 500; font-family: 'DM Sans', sans-serif; border-radius: 8px; cursor: pointer; margin-bottom: 12px; transition: opacity 0.15s; box-shadow: 0 0 20px var(--blue-glow); }
    .modal-submit:hover { opacity: 0.85; }
    .modal-submit:disabled { opacity: 0.35; cursor: not-allowed; box-shadow: none; }
    .modal-switch { text-align: center; font-size: 13px; color: var(--text-muted); }
    .modal-switch a { color: var(--blue); font-weight: 500; cursor: pointer; text-decoration: underline; text-underline-offset: 3px; }
  </style>
</head>
<body>
<div class="page">

  <!-- Modal -->
  <div class="modal-bg" id="authModal">
    <div class="modal">
      <button class="modal-x" onclick="closeModal()">‚úï</button>
      <div class="modal-title" id="mTitle">Sign in</div>
      <div class="modal-sub" id="mSub">Welcome back to Signum</div>
      <div class="modal-msg" id="mMsg"></div>
      <input class="modal-input" type="email" id="mEmail" placeholder="Email address" autocomplete="email" />
      <input class="modal-input" type="password" id="mPass" placeholder="Password" onkeydown="if(event.key==='Enter')doAuth()" />
      <button class="modal-submit" id="mBtn" onclick="doAuth()">Sign in</button>
      <div class="modal-switch" id="mSwitch">Don't have an account? <a onclick="toggleMode()">Sign up free</a></div>
    </div>
  </div>

  <!-- Nav -->
  <nav>
    <a class="logo" href="#">
      <div class="logo-icon">
        <svg viewBox="0 0 15 15"><polyline points="2,11 5,7 8,9 13,3"/></svg>
      </div>
      Signum
    </a>
    <div class="nav-right">
      <div class="lang-toggle">
        <button class="lang-btn active" id="btnEN" onclick="setLang('en')">EN</button>
        <button class="lang-btn" id="btnBG" onclick="setLang('bg')">–ë–ì</button>
      </div>
      <div id="navAuth">
        <button class="btn-sm btn-blue" onclick="openModal()">Sign in</button>
      </div>
    </div>
  </nav>

  <!-- Hero -->
  <div class="hero">
    <div class="hero-badge">
      <span class="badge-dot"></span>
      <span id="tBadge">20 intelligence sources ¬∑ Live analysis</span>
    </div>
    <h1 class="hero-title" id="tHeroTitle">Check if any website<br/>is <em>safe to trust.</em></h1>
    <p class="hero-sub" id="tHeroSub">Paste any URL and get an instant risk report powered by 20 global data sources and AI-driven analysis.</p>
  </div>

  <!-- Plan banners -->
  <div class="plan-banner free" id="freeBanner">
    <div>
      <div class="banner-label" id="tFreePlanLabel">Free plan</div>
      <div class="banner-sub" id="tFreePlanSub">3 scans per day</div>
    </div>
    <button class="btn-upgrade" id="upgBtn" onclick="upgradeToPro()">Upgrade to Pro</button>
  </div>
  <div class="plan-banner pro" id="proBanner">
    <div>
      <div class="banner-label" id="tProPlanLabel">Pro plan</div>
      <div class="banner-sub" id="tProPlanSub">Unlimited scans</div>
    </div>
  </div>

  <div class="msg success" id="successMsg"></div>

  <!-- Search -->
  <div class="search-wrap">
    <div class="search-box">
      <input class="search-input" type="text" id="urlInput" onkeydown="if(event.key==='Enter')runScan()" />
      <button class="search-btn" id="scanBtn" onclick="runScan()">Analyze</button>
    </div>
    <div class="search-hint" id="tHint">No account required ¬∑ Results in ~20 seconds</div>
  </div>

  <!-- How it works -->
  <div class="how-wrap" id="howSection">
    <div class="how-step">
      <div class="how-num">01</div>
      <div class="how-title" id="tH1">Enter URL</div>
      <div class="how-sub" id="tH1s">Paste any website address into the field above.</div>
    </div>
    <div class="how-step">
      <div class="how-num">02</div>
      <div class="how-title" id="tH2">Scan signals</div>
      <div class="how-sub" id="tH2s">We query 20 global intelligence sources simultaneously.</div>
    </div>
    <div class="how-step">
      <div class="how-num">03</div>
      <div class="how-title" id="tH3">Get report</div>
      <div class="how-sub" id="tH3s">Receive a clear risk score with full explanation.</div>
    </div>
  </div>

  <!-- Status -->
  <div class="status-wrap" id="statusWrap">
    <div class="status-inner">
      <div class="spinner"></div>
      <div class="status-text" id="statusText">Initializing...</div>
    </div>
  </div>
  <div class="msg error" id="errorMsg"></div>

  <!-- Report -->
  <div class="report" id="reportSection">

    <div class="verdict-card" id="verdictCard">
      <div class="verdict-top">
        <div class="score-ring">
          <svg viewBox="0 0 80 80">
            <circle class="score-ring-bg" cx="40" cy="40" r="33"/>
            <circle class="score-ring-fill" id="scoreArc" cx="40" cy="40" r="33" stroke-dasharray="207" stroke-dashoffset="207"/>
          </svg>
          <div class="score-center">
            <div class="score-num" id="scoreNum">0</div>
            <div class="score-lbl">RISK</div>
          </div>
        </div>
        <div class="verdict-meta">
          <div class="verdict-label" id="verdictLabel">‚Äî</div>
          <div class="verdict-summary" id="verdictSummary"></div>
          <button class="share-btn" onclick="shareReport()" id="tShareBtn">‚Üó Share report</button>
        </div>
      </div>

      <!-- Security Dashboard -->
      <div class="dashboard" id="dashboardWrap">
        <div class="confidence-row">
          <span class="confidence-label" id="tConfLabel">CONFIDENCE LEVEL</span>
          <span class="confidence-badge" id="confBadge">‚Äî</span>
        </div>
        <div id="dashSignals"></div>
      </div>
    </div>

    <div class="section">
      <div class="section-header" id="tFindings">Findings</div>
      <div id="findingsList"></div>
    </div>

    <div class="section">
      <div class="section-header" id="tAnalysis">AI Analysis</div>
      <div class="narrative" id="narrativeText"></div>
    </div>

    <div class="section">
      <button class="raw-btn" onclick="toggleRaw()">
        <span id="rawArrow">‚ñ∏</span> <span id="tRawLabel">Raw intelligence data</span>
      </button>
      <div class="data-grid" id="dataGrid"></div>
    </div>
  </div>

  <!-- Trust Strip -->
  <div class="trust-strip">
    <div class="trust-item"><span class="trust-icon">üîí</span><span id="tT1">Encrypted scanning</span></div>
    <div class="trust-item"><span class="trust-icon">üõ°</span><span id="tT2">Privacy focused</span></div>
    <div class="trust-item"><span class="trust-icon">‚ö°</span><span id="tT3">Real-time analysis</span></div>
    <div class="trust-item"><span class="trust-icon">üåç</span><span id="tT4">20 global sources</span></div>
  </div>

  <!-- Pricing -->
  <div class="pricing">
    <div class="pricing-head">
      <h2 class="pricing-title" id="tPricingTitle">Simple, transparent pricing</h2>
      <p class="pricing-sub" id="tPricingSub">Start free. Upgrade anytime.</p>
    </div>
    <div class="pricing-grid">
      <div class="pricing-card">
        <div class="plan-name">Free</div>
        <div class="plan-price">$0</div>
        <div class="plan-period" id="tFreePeriod">forever</div>
        <ul class="plan-features">
          <li><span class="fi">‚úì</span><span id="tPF1">3 scans per day</span></li>
          <li><span class="fi">‚úì</span><span id="tPF2">20 intelligence sources</span></li>
          <li><span class="fi">‚úì</span><span id="tPF3">AI risk analysis</span></li>
          <li class="muted"><span class="fi">‚Äì</span><span id="tPF4">Unlimited scans</span></li>
          <li class="muted"><span class="fi">‚Äì</span><span id="tPF5">Scan history</span></li>
          <li class="muted"><span class="fi">‚Äì</span><span id="tPF6">Priority support</span></li>
        </ul>
        <button class="plan-cta outline" onclick="openModal()" id="tFreeCta">Get started free</button>
      </div>
      <div class="pricing-card pro">
        <div class="popular-badge" id="tPopular">MOST POPULAR</div>
        <div class="plan-name">Pro</div>
        <div class="plan-price">$3.99</div>
        <div class="plan-period" id="tProPeriod">per month</div>
        <ul class="plan-features">
          <li><span class="fi">‚úì</span><span id="tPP1">Unlimited scans</span></li>
          <li><span class="fi">‚úì</span><span id="tPP2">20 intelligence sources</span></li>
          <li><span class="fi">‚úì</span><span id="tPP3">AI risk analysis</span></li>
          <li><span class="fi">‚úì</span><span id="tPP4">Scan history</span></li>
          <li><span class="fi">‚úì</span><span id="tPP5">Priority support</span></li>
          <li><span class="fi">‚úì</span><span id="tPP6">New sources as added</span></li>
        </ul>
        <button class="plan-cta filled" onclick="upgradeToPro()" id="tProCta">Upgrade to Pro</button>
      </div>
    </div>
    <div class="pricing-note" id="tPricingNote">Cancel anytime ¬∑ Billed monthly ¬∑ Renews automatically</div>
  </div>

</div>
<script>
var BACKEND = "https://detective-app-production-7080.up.railway.app";
var SB_URL  = "https://harhjuykvkfwksccjjxq.supabase.co";
var SB_KEY  = "REPLACE_WITH_YOUR_SUPABASE_ANON_KEY";

var user=null, token=null, plan="free", mode="signin", lang="en";

var I = {
  en:{
    badge:"20 intelligence sources ¬∑ Live analysis",
    heroTitle:"Check if any website<br/>is <em>safe to trust.</em>",
    heroSub:"Paste any URL and get an instant risk report powered by 20 global data sources and AI-driven analysis.",
    scanBtn:"Analyze", placeholder:"Enter a URL, e.g. example.com",
    hint:"No account required ¬∑ Results in ~20 seconds",
    freePlanLabel:"Free plan", freePlanSub:"3 scans per day",
    proPlanLabel:"Pro plan", proPlanSub:"Unlimited scans",
    upgradeBtn:"Upgrade to Pro", signInBtn:"Sign in", signOutBtn:"Sign out",
    h1:"Enter URL", h1s:"Paste any website address into the field above.",
    h2:"Scan signals", h2s:"We query 20 global intelligence sources simultaneously.",
    h3:"Get report", h3s:"Receive a clear risk score with full explanation.",
    findings:"Findings", analysis:"AI Analysis", rawLabel:"Raw intelligence data",
    shareBtn:"‚Üó Share report", confLabel:"CONFIDENCE LEVEL",
    t1:"Encrypted scanning", t2:"Privacy focused", t3:"Real-time analysis", t4:"20 global sources",
    pricingTitle:"Simple, transparent pricing", pricingSub:"Start free. Upgrade anytime.",
    freePeriod:"forever", proPeriod:"per month", popular:"MOST POPULAR",
    pf:["3 scans per day","20 intelligence sources","AI risk analysis","Unlimited scans","Scan history","Priority support"],
    pp:["Unlimited scans","20 intelligence sources","AI risk analysis","Scan history","Priority support","New sources as added"],
    freeCta:"Get started free", proCta:"Upgrade to Pro",
    pricingNote:"Cancel anytime ¬∑ Billed monthly ¬∑ Renews automatically",
    verdicts:{GREEN:"Safe",YELLOW:"Caution",RED:"Danger"},
    conf:{high:"High Confidence",med:"Medium Confidence",low:"Low Confidence"},
    status:["Initializing scan...","Querying domain registry...","Running malware scan...","Checking Safe Browsing...","Verifying SSL certificate...","Searching global registries...","Scanning community signals...","Checking sanctions lists...","Running live page analysis...","Consulting AI analyst...","Compiling report..."],
    limitMsg:"Daily limit reached ‚Äî upgrade to Pro for unlimited scans.",
    serverErr:"Could not reach server. Please try again.",
    upgradeOk:"Welcome to Pro! Unlimited scans unlocked.",
    mSignInTitle:"Sign in", mSignInSub:"Welcome back to Signum",
    mSignUpTitle:"Create account", mSignUpSub:"3 free scans per day, no credit card",
    mSignInSwitch:"Don't have an account? <a onclick=\"toggleMode()\">Sign up free</a>",
    mSignUpSwitch:"Already have an account? <a onclick=\"toggleMode()\">Sign in</a>",
    mSignInBtn:"Sign in", mSignUpBtn:"Create account",
    mSignUpOk:"Account created! Check your email to confirm, then sign in.",
  },
  bg:{
    badge:"20 —Ä–∞–∑—É–∑–Ω–∞–≤–∞—Ç–µ–ª–Ω–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ ¬∑ –ê–Ω–∞–ª–∏–∑ –≤ —Ä–µ–∞–ª–Ω–æ –≤—Ä–µ–º–µ",
    heroTitle:"–ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ –¥–∞–¥–µ–Ω —Å–∞–π—Ç<br/>–µ <em>–±–µ–∑–æ–ø–∞—Å–µ–Ω.</em>",
    heroSub:"–í—ä–≤–µ–¥–µ—Ç–µ URL –∏ –ø–æ–ª—É—á–µ—Ç–µ –º–æ–º–µ–Ω—Ç–∞–ª–µ–Ω –¥–æ–∫–ª–∞–¥ –∑–∞ —Ä–∏—Å–∫–∞ –æ—Ç 20 –≥–ª–æ–±–∞–ª–Ω–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏ AI –∞–Ω–∞–ª–∏–∑.",
    scanBtn:"–ê–Ω–∞–ª–∏–∑–∏—Ä–∞–π", placeholder:"–í—ä–≤–µ–¥–µ—Ç–µ URL, –Ω–∞–ø—Ä. example.com",
    hint:"–ù–µ —Å–µ –∏–∑–∏—Å–∫–≤–∞ –∞–∫–∞—É–Ω—Ç ¬∑ –†–µ–∑—É–ª—Ç–∞—Ç –∑–∞ ~20 —Å–µ–∫—É–Ω–¥–∏",
    freePlanLabel:"–ë–µ–∑–ø–ª–∞—Ç–µ–Ω –ø–ª–∞–Ω", freePlanSub:"3 –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥–µ–Ω",
    proPlanLabel:"Pro –ø–ª–∞–Ω", proPlanSub:"–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏",
    upgradeBtn:"–ù–∞–¥–≥—Ä–∞–¥–µ—Ç–µ –¥–æ Pro", signInBtn:"–í—Ö–æ–¥", signOutBtn:"–ò–∑—Ö–æ–¥",
    h1:"–í—ä–≤–µ–¥–µ—Ç–µ URL", h1s:"–ü–æ—Å—Ç–∞–≤–µ—Ç–µ –∞–¥—Ä–µ—Å–∞ –Ω–∞ —Å–∞–π—Ç–∞ –≤ –ø–æ–ª–µ—Ç–æ –ø–æ-–≥–æ—Ä–µ.",
    h2:"–°–∫–∞–Ω–∏—Ä–∞–Ω–µ", h2s:"–ü—Ä–æ–≤–µ—Ä—è–≤–∞–º–µ 20 –≥–ª–æ–±–∞–ª–Ω–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –µ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.",
    h3:"–ü–æ–ª—É—á–µ—Ç–µ –¥–æ–∫–ª–∞–¥", h3s:"–Ø—Å–Ω–∞ –æ—Ü–µ–Ω–∫–∞ –Ω–∞ —Ä–∏—Å–∫–∞ —Å –ø—ä–ª–Ω–æ –æ–±—è—Å–Ω–µ–Ω–∏–µ.",
    findings:"–û—Ç–∫—Ä–∏—Ç–∏—è", analysis:"AI –ê–Ω–∞–ª–∏–∑", rawLabel:"–°—É—Ä–æ–≤–∏ –¥–∞–Ω–Ω–∏",
    shareBtn:"‚Üó –°–ø–æ–¥–µ–ª–∏ –¥–æ–∫–ª–∞–¥", confLabel:"–ù–ò–í–û –ù–ê –£–í–ï–†–ï–ù–û–°–¢",
    t1:"–ö—Ä–∏–ø—Ç–∏—Ä–∞–Ω–æ —Å–∫–∞–Ω–∏—Ä–∞–Ω–µ", t2:"–§–æ–∫—É—Å –≤—ä—Ä—Ö—É –ø–æ–≤–µ—Ä–∏—Ç–µ–ª–Ω–æ—Å—Ç", t3:"–ê–Ω–∞–ª–∏–∑ –≤ —Ä–µ–∞–ª–Ω–æ –≤—Ä–µ–º–µ", t4:"20 –≥–ª–æ–±–∞–ª–Ω–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞",
    pricingTitle:"–ü—Ä–æ–∑—Ä–∞—á–Ω–∏ —Ü–µ–Ω–∏", pricingSub:"–ó–∞–ø–æ—á–Ω–µ—Ç–µ –±–µ–∑–ø–ª–∞—Ç–Ω–æ. –ù–∞–¥–≥—Ä–∞–¥–µ—Ç–µ –∫–æ–≥–∞ –∏—Å–∫–∞—Ç–µ.",
    freePeriod:"–∑–∞–≤–∏–Ω–∞–≥–∏", proPeriod:"–Ω–∞ –º–µ—Å–µ—Ü", popular:"–ù–ê–ô-–ü–û–ü–£–õ–Ø–†–ï–ù",
    pf:["3 –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥–µ–Ω","20 –∏—Å—Ç–æ—á–Ω–∏–∫–∞","AI –∞–Ω–∞–ª–∏–∑","–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏","–ò—Å—Ç–æ—Ä–∏—è","–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞ –ø–æ–¥–¥—Ä—ä–∂–∫–∞"],
    pp:["–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏","20 –∏—Å—Ç–æ—á–Ω–∏–∫–∞","AI –∞–Ω–∞–ª–∏–∑","–ò—Å—Ç–æ—Ä–∏—è","–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞ –ø–æ–¥–¥—Ä—ä–∂–∫–∞","–ù–æ–≤–∏ –∏–∑—Ç–æ—á–Ω–∏—Ü–∏"],
    freeCta:"–ó–∞–ø–æ—á–Ω–µ—Ç–µ –±–µ–∑–ø–ª–∞—Ç–Ω–æ", proCta:"–ù–∞–¥–≥—Ä–∞–¥–µ—Ç–µ –¥–æ Pro",
    pricingNote:"–ê–Ω—É–ª–∏—Ä–∞–π—Ç–µ –ø–æ –≤—Å—è–∫–æ –≤—Ä–µ–º–µ ¬∑ –ú–µ—Å–µ—á–Ω–æ —Ç–∞–∫—Å—É–≤–∞–Ω–µ ¬∑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–æ–¥–Ω–æ–≤—è–≤–∞–Ω–µ",
    verdicts:{GREEN:"–ë–µ–∑–æ–ø–∞—Å–µ–Ω",YELLOW:"–í–Ω–∏–º–∞–Ω–∏–µ",RED:"–û–ø–∞—Å–Ω–æ—Å—Ç"},
    conf:{high:"–í–∏—Å–æ–∫–∞ —É–≤–µ—Ä–µ–Ω–æ—Å—Ç",med:"–°—Ä–µ–¥–Ω–∞ —É–≤–µ—Ä–µ–Ω–æ—Å—Ç",low:"–ù–∏—Å–∫–∞ —É–≤–µ—Ä–µ–Ω–æ—Å—Ç"},
    status:["–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–µ...","–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–æ–º–µ–π–Ω —Ä–µ–≥–∏—Å—Ç—ä—Ä–∞...","–°–∫–∞–Ω–∏—Ä–∞–Ω–µ –∑–∞ –∑–ª–æ–Ω–∞–º–µ—Ä–µ–Ω —Å–æ—Ñ—Ç—É–µ—Ä...","–ü—Ä–æ–≤–µ—Ä–∫–∞ Safe Browsing...","–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–∞–Ω–µ –Ω–∞ SSL...","–¢—ä—Ä—Å–µ–Ω–µ –≤ –≥–ª–æ–±–∞–ª–Ω–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏...","–°–∫–∞–Ω–∏—Ä–∞–Ω–µ –Ω–∞ –æ–±—â–Ω–æ—Å—Ç—Ç–∞...","–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–∞–Ω–∫—Ü–∏–∏...","–ê–Ω–∞–ª–∏–∑ –Ω–∞ –∂–∏–≤–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞...","–ö–æ–Ω—Å—É–ª—Ç–∏—Ä–∞–Ω–µ —Å AI...","–°—ä—Å—Ç–∞–≤—è–Ω–µ –Ω–∞ –¥–æ–∫–ª–∞–¥..."],
    limitMsg:"–î–æ—Å—Ç–∏–≥–Ω–∞—Ç –¥–Ω–µ–≤–µ–Ω –ª–∏–º–∏—Ç ‚Äî –Ω–∞–¥–≥—Ä–∞–¥–µ—Ç–µ –¥–æ Pro –∑–∞ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏.",
    serverErr:"–°—ä—Ä–≤—ä—Ä—ä—Ç –Ω–µ –æ—Ç–≥–æ–≤–∞—Ä—è. –ú–æ–ª—è –æ–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ.",
    upgradeOk:"–î–æ–±—Ä–µ –¥–æ—à–ª–∏ –≤ Pro! –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏.",
    mSignInTitle:"–í—Ö–æ–¥", mSignInSub:"–î–æ–±—Ä–µ –¥–æ—à–ª–∏ –æ–±—Ä–∞—Ç–Ω–æ –≤ Signum",
    mSignUpTitle:"–°—ä–∑–¥–∞–π—Ç–µ –∞–∫–∞—É–Ω—Ç", mSignUpSub:"3 –±–µ–∑–ø–ª–∞—Ç–Ω–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥–µ–Ω",
    mSignInSwitch:"–ù—è–º–∞—Ç–µ –∞–∫–∞—É–Ω—Ç? <a onclick=\"toggleMode()\">–†–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–π—Ç–µ —Å–µ</a>",
    mSignUpSwitch:"–í–µ—á–µ –∏–º–∞—Ç–µ –∞–∫–∞—É–Ω—Ç? <a onclick=\"toggleMode()\">–í–ª–µ–∑—Ç–µ</a>",
    mSignInBtn:"–í—Ö–æ–¥", mSignUpBtn:"–°—ä–∑–¥–∞–π –∞–∫–∞—É–Ω—Ç",
    mSignUpOk:"–ê–∫–∞—É–Ω—Ç—ä—Ç –µ —Å—ä–∑–¥–∞–¥–µ–Ω! –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –∏–º–µ–π–ª–∞ —Å–∏, —Å–ª–µ–¥ –∫–æ–µ—Ç–æ –≤–ª–µ–∑—Ç–µ.",
  }
};

function tr(k){ return I[lang][k]||I.en[k]||k; }

function setLang(l){
  lang=l; localStorage.setItem("sg_lang",l);
  document.getElementById("btnEN").className="lang-btn"+(l==="en"?" active":"");
  document.getElementById("btnBG").className="lang-btn"+(l==="bg"?" active":"");
  applyLang();
}

function applyLang(){
  var pairs={
    tBadge:"badge",tHeroSub:"heroSub",tHint:"hint",
    tFreePlanLabel:"freePlanLabel",tFreePlanSub:"freePlanSub",
    tProPlanLabel:"proPlanLabel",tProPlanSub:"proPlanSub",
    tH1:"h1",tH1s:"h1s",tH2:"h2",tH2s:"h2s",tH3:"h3",tH3s:"h3s",
    tFindings:"findings",tAnalysis:"analysis",tRawLabel:"rawLabel",tShareBtn:"shareBtn",tConfLabel:"confLabel",
    tT1:"t1",tT2:"t2",tT3:"t3",tT4:"t4",
    tPricingTitle:"pricingTitle",tPricingSub:"pricingSub",
    tFreePeriod:"freePeriod",tProPeriod:"proPeriod",tPopular:"popular",
    tFreeCta:"freeCta",tProCta:"proCta",tPricingNote:"pricingNote"
  };
  Object.keys(pairs).forEach(function(id){
    var el=document.getElementById(id); if(el) el.textContent=tr(pairs[id]);
  });
  document.getElementById("tHeroTitle").innerHTML=tr("heroTitle");
  tr("pf").forEach(function(f,i){ var el=document.getElementById("tPF"+(i+1)); if(el) el.textContent=f; });
  tr("pp").forEach(function(f,i){ var el=document.getElementById("tPP"+(i+1)); if(el) el.textContent=f; });
  document.getElementById("scanBtn").textContent=tr("scanBtn");
  document.getElementById("urlInput").placeholder=tr("placeholder");
  var ub=document.getElementById("upgBtn"); if(ub) ub.textContent=tr("upgradeBtn");
  updateUI();
}

// ‚îÄ‚îÄ Auth ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function sbIn(e,p){ return fetch(SB_URL+"/auth/v1/token?grant_type=password",{method:"POST",headers:{"Content-Type":"application/json","apikey":SB_KEY},body:JSON.stringify({email:e,password:p})}).then(function(r){return r.json();}); }
function sbUp(e,p){ return fetch(SB_URL+"/auth/v1/signup",{method:"POST",headers:{"Content-Type":"application/json","apikey":SB_KEY},body:JSON.stringify({email:e,password:p})}).then(function(r){return r.json();}); }
function sbOut(){
  if(token) fetch(SB_URL+"/auth/v1/logout",{method:"POST",headers:{"Authorization":"Bearer "+token,"apikey":SB_KEY}});
  user=null; token=null; plan="free";
  localStorage.removeItem("sg_token"); localStorage.removeItem("sg_user"); localStorage.removeItem("sg_plan");
  updateUI();
}
function fetchPlan(uid){
  fetch(SB_URL+"/rest/v1/profiles?id=eq."+uid+"&select=plan,subscription_status",{headers:{"apikey":SB_KEY,"Authorization":"Bearer "+token}})
  .then(function(r){return r.json();}).then(function(d){
    if(d&&d[0]){ plan=(d[0].subscription_status==="active")?d[0].plan:"free"; localStorage.setItem("sg_plan",plan); updateUI(); }
  }).catch(function(){});
}

window.addEventListener("load",function(){
  lang=localStorage.getItem("sg_lang")||"en";
  setLang(lang);
  var st=localStorage.getItem("sg_token"), su=localStorage.getItem("sg_user");
  if(st&&st!=="null"&&su&&su!=="null"){
    try{ token=st; user=JSON.parse(su); plan=localStorage.getItem("sg_plan")||"free"; fetchPlan(user.id); }
    catch(e){ localStorage.clear(); }
  }
  var p=new URLSearchParams(window.location.search);
  if(p.get("upgrade")==="success"){
    plan="pro"; localStorage.setItem("sg_plan","pro");
    showMsg("successMsg",tr("upgradeOk"));
    window.history.replaceState({},"",location.pathname);
  }
  updateUI(); applyLang();
});

function updateUI(){
  var navAuth=document.getElementById("navAuth");
  var fb=document.getElementById("freeBanner");
  var pb=document.getElementById("proBanner");
  if(user){
    navAuth.innerHTML='<span class="nav-email">'+user.email+'</span>&nbsp;<button class="btn-sm btn-outline" onclick="sbOut()">'+tr("signOutBtn")+'</button>';
    fb.style.display=plan==="pro"?"none":"flex";
    pb.style.display=plan==="pro"?"flex":"none";
  } else {
    navAuth.innerHTML='<button class="btn-sm btn-blue" onclick="openModal()">'+tr("signInBtn")+'</button>';
    fb.style.display="none"; pb.style.display="none";
  }
}

function openModal(){ document.getElementById("authModal").classList.add("open"); setModalMode(mode); document.getElementById("mEmail").focus(); }
function closeModal(){ document.getElementById("authModal").classList.remove("open"); }
function setModalMode(m){
  mode=m; var s=m==="signin";
  document.getElementById("mTitle").textContent=s?tr("mSignInTitle"):tr("mSignUpTitle");
  document.getElementById("mSub").textContent=s?tr("mSignInSub"):tr("mSignUpSub");
  document.getElementById("mBtn").textContent=s?tr("mSignInBtn"):tr("mSignUpBtn");
  document.getElementById("mSwitch").innerHTML=s?tr("mSignInSwitch"):tr("mSignUpSwitch");
  document.getElementById("mMsg").className="modal-msg";
}
function toggleMode(){ setModalMode(mode==="signin"?"signup":"signin"); }

function doAuth(){
  var e=document.getElementById("mEmail").value.trim();
  var p=document.getElementById("mPass").value;
  var btn=document.getElementById("mBtn");
  if(!e||!p){ showModalMsg("Please enter email and password.","error"); return; }
  btn.disabled=true; btn.textContent="...";
  var pr=mode==="signin"?sbIn(e,p):sbUp(e,p);
  pr.then(function(d){
    btn.disabled=false; btn.textContent=mode==="signin"?tr("mSignInBtn"):tr("mSignUpBtn");
    if(d.error||d.error_description){ showModalMsg(d.error_description||d.error,"error"); return; }
    if(mode==="signup"&&!d.access_token){ showModalMsg(tr("mSignUpOk"),"success"); return; }
    token=d.access_token; user=d.user;
    localStorage.setItem("sg_token",token); localStorage.setItem("sg_user",JSON.stringify(user));
    fetchPlan(user.id); updateUI(); closeModal();
  }).catch(function(){ btn.disabled=false; btn.textContent=mode==="signin"?tr("mSignInBtn"):tr("mSignUpBtn"); showModalMsg("Connection error.","error"); });
}
function showModalMsg(t,type){ var el=document.getElementById("mMsg"); el.textContent=t; el.className="modal-msg "+type+" visible"; }

// ‚îÄ‚îÄ Upgrade ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function upgradeToPro(){
  if(!user||!token||token==="null"){ openModal(); return; }
  var btn=document.getElementById("upgBtn");
  if(btn){ btn.textContent="..."; btn.disabled=true; }
  fetch(BACKEND+"/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_token:token,user_email:user.email})})
  .then(function(r){return r.json();}).then(function(d){
    if(d.checkout_url){ window.location.href=d.checkout_url; }
    else{ alert("Could not start checkout."); if(btn){btn.textContent=tr("upgradeBtn");btn.disabled=false;} }
  }).catch(function(){ alert("Could not start checkout."); if(btn){btn.textContent=tr("upgradeBtn");btn.disabled=false;} });
}

// ‚îÄ‚îÄ Scan ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function runScan(){
  var url=document.getElementById("urlInput").value.trim();
  if(!url) return;
  document.getElementById("reportSection").classList.remove("visible");
  document.getElementById("errorMsg").classList.remove("visible");
  document.getElementById("howSection").style.display="none";
  var sw=document.getElementById("statusWrap"), st=document.getElementById("statusText");
  sw.classList.add("visible");
  var steps=tr("status"), i=0;
  var iv=setInterval(function(){ if(i<steps.length) st.textContent=steps[i++]; },1300);
  document.getElementById("scanBtn").disabled=true;
  var body={target:url};
  if(token&&token!=="null") body.user_token=token;
  fetch(BACKEND+"/investigate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(body)})
  .then(function(res){
    clearInterval(iv); document.getElementById("scanBtn").disabled=false; sw.classList.remove("visible");
    if(res.status===429){ showMsg("errorMsg",tr("limitMsg")); return null; }
    return res.json().then(function(d){ if(!res.ok){ showMsg("errorMsg",d.detail||tr("serverErr")); return null; } return d; });
  }).then(function(d){ if(d) renderReport(d); })
  .catch(function(){ clearInterval(iv); document.getElementById("scanBtn").disabled=false; sw.classList.remove("visible"); showMsg("errorMsg",tr("serverErr")); });
}

// ‚îÄ‚îÄ Render ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderReport(r){
  var card=document.getElementById("verdictCard");
  card.className="verdict-card "+r.verdict;
  var circ=207;
  var arc=document.getElementById("scoreArc");
  arc.style.strokeDashoffset=circ;
  setTimeout(function(){ arc.style.strokeDashoffset=circ-(r.score/100)*circ; },60);
  document.getElementById("scoreNum").textContent=r.score;
  document.getElementById("verdictLabel").textContent=(tr("verdicts")[r.verdict])||r.verdict;
  document.getElementById("verdictSummary").textContent=r.verdict_summary;

  // Confidence level
  var conf = r.score >= 70 ? "high" : r.score >= 40 ? "med" : "low";
  var confEl = document.getElementById("confBadge");
  confEl.textContent = tr("conf")[conf];
  confEl.className = "confidence-badge conf-"+conf;

  // Dashboard signals ‚Äî top 5 findings as clean signals
  var signals=document.getElementById("dashSignals");
  signals.innerHTML="";
  (r.findings||[]).slice(0,5).forEach(function(f){
    var icon = f.tag==="OK" ? "‚úî" : f.tag==="RISK" ? "‚úñ" : "‚ö†";
    var color = f.tag==="OK" ? "var(--green)" : f.tag==="RISK" ? "var(--red)" : "var(--yellow)";
    signals.innerHTML+='<div class="dashboard-row"><span class="dash-icon" style="color:'+color+'">'+icon+'</span><span>'+f.text+'</span></div>';
  });

  // Findings
  var list=document.getElementById("findingsList");
  list.innerHTML="";
  (r.findings||[]).forEach(function(f){
    var tc=f.tag==="RISK"?"RISK":f.tag==="OK"?"OK":"CAUTION";
    list.innerHTML+='<div class="finding"><div class="f-icon">'+f.icon+'</div><div class="f-body"><div class="f-tag '+tc+'">'+f.tag+'</div><div class="f-text">'+f.text+'</div></div></div>';
  });

  document.getElementById("narrativeText").textContent=r.narrative;

  var grid=document.getElementById("dataGrid");
  grid.innerHTML="";
  Object.entries(r.raw_labels||{}).forEach(function(e){
    grid.innerHTML+='<div class="data-cell"><div class="data-lbl">'+e[0]+'</div><div class="data-val">'+e[1]+'</div></div>';
  });

  document.getElementById("reportSection").classList.add("visible");
  document.getElementById("reportSection").scrollIntoView({behavior:"smooth"});
}

function toggleRaw(){
  var g=document.getElementById("dataGrid"), a=document.getElementById("rawArrow");
  g.classList.toggle("open"); a.textContent=g.classList.contains("open")?"‚ñæ":"‚ñ∏";
}

function shareReport(){
  var url=document.getElementById("urlInput").value.trim();
  var score=document.getElementById("scoreNum").textContent;
  var verdict=document.getElementById("verdictLabel").textContent;
  var text="I checked "+url+" on Signum ‚Äî Risk score: "+score+"/100 ("+verdict+"). Check any website for free: "+location.origin;
  if(navigator.share){ navigator.share({title:"Signum Security Report",text:text,url:location.href}); }
  else{ navigator.clipboard.writeText(text).then(function(){ alert("Copied to clipboard!"); }).catch(function(){ alert(text); }); }
}

function showMsg(id,txt){ var el=document.getElementById(id); el.textContent=txt; el.classList.add("visible"); }
</script>
</body>
</html>
